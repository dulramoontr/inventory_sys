<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>參數設定 - 庫存系統</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0d1a2e;
            background-image:
                radial-gradient(ellipse at 10% 20%, rgba(66, 153, 225, 0.25) 0%, transparent 70%),
                radial-gradient(ellipse at 90% 30%, rgba(213, 63, 140, 0.2) 0%, transparent 70%),
                radial-gradient(ellipse at 70% 85%, rgba(128, 90, 213, 0.25) 0%, transparent 70%);
            background-attachment: fixed;
            color: #E0E0E0;
        }
        .glass-card { 
            background: rgba(30, 41, 59, 0.5); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
        }
        /* --- New Loader Styles --- */
        .loader { 
            position: fixed; 
            inset: 0; 
            z-index: 9999; 
            background-color: rgba(10, 20, 35, 0.5); 
            backdrop-filter: blur(8px); 
            -webkit-backdrop-filter: blur(8px); 
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .ball-grid-pulse {
            width: 57px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 5px;
        }
        
        .ball-grid-pulse > div {
            width: 15px;
            height: 15px;
            background-color: #60a5fa;
            border-radius: 100%;
            animation: ball-grid-pulse 1.3s ease-in-out infinite; 
        }
        
        .ball-grid-pulse > div:nth-child(1) { animation-delay: 0.03s; }
        .ball-grid-pulse > div:nth-child(2) { animation-delay: 0.23s; }
        .ball-grid-pulse > div:nth-child(3) { animation-delay: 0.5s; }
        .ball-grid-pulse > div:nth-child(4) { animation-delay: 0.1s; }
        .ball-grid-pulse > div:nth-child(5) { animation-delay: 0.32s; }
        .ball-grid-pulse > div:nth-child(6) { animation-delay: 0.35s; }
        .ball-grid-pulse > div:nth-child(7) { animation-delay: -0.3s; }
        .ball-grid-pulse > div:nth-child(8) { animation-delay: 0.1s; }
        .ball-grid-pulse > div:nth-child(9) { animation-delay: -0.15s; }
        
        @keyframes ball-grid-pulse {
            0%, 70%, 100% {
                transform: scale(1);
            }
            35% {
                transform: scale(0.1);
            }
        }
        .hidden { display: none !important; }
        .modal { background-color: rgba(0,0,0,0.5); backdrop-filter: blur(8px); }
        .drag-handle { cursor: grab; padding: 0 8px; color: #94a3b8; }
        .sortable-ghost { background: rgba(30, 41, 59, 0.8); border-radius: 0.5rem; }
        
        input, select {
            background-color: rgba(15, 23, 42, 0.7);
            border: 1px solid #334155;
            color: #e2e8f0;
        }
        input:focus, select:focus {
            box-shadow: none;
            border-color: #38bdf8;
            background-color: #0f172a;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto max-w-4xl p-4 sm:p-6">

        <header class="flex items-center justify-center relative my-8">
            <a href="index.html" class="absolute left-0 text-slate-300 hover:text-sky-400 transition">
                <span class="material-symbols-outlined text-3xl">arrow_circle_left</span>
            </a>
            <h1 class="text-2xl sm:text-3xl font-bold text-slate-100 tracking-wider">參數設定</h1>
            <a href="index.html" class="absolute right-0 text-slate-300 hover:text-sky-400 transition" title="回到首頁">
                <span class="material-symbols-outlined text-3xl">home</span>
            </a>
        </header>

        <main id="settings-content" class="hidden">
            <div class="main-tabs flex space-x-2 p-1 bg-slate-900/50 rounded-full mb-6">
                <button class="main-tab-link flex-1 py-2 px-4 text-center text-slate-300 rounded-full transition-all duration-300" data-tab="settings-tab-code">存取碼修改</button>
                <button class="main-tab-link flex-1 py-2 px-4 text-center text-slate-300 rounded-full transition-all duration-300" data-tab="settings-tab-logs">盤點紀錄管理</button>
                <button class="main-tab-link flex-1 py-2 px-4 text-center text-slate-300 rounded-full transition-all duration-300" data-tab="settings-tab-items">品項設定</button>
            </div>

            <div id="settings-tab-code" class="main-tab-content p-6 rounded-2xl shadow-lg glass-card hidden">
                <h3 class="text-xl font-bold text-slate-200 mb-4">存取碼修改</h3>
                <div class="space-y-4 max-w-md mx-auto">
                    <input type="password" id="old-access-code" placeholder="舊存取碼" class="w-full p-3 rounded-lg">
                    <input type="password" id="new-access-code" placeholder="新存取碼" class="w-full p-3 rounded-lg">
                    <button id="save-code-btn" class="w-full flex items-center justify-center gap-2 py-3 px-4 bg-gradient-to-r from-sky-500 to-indigo-600 text-white font-bold rounded-lg shadow-md hover:shadow-lg transition-all">
                        <span class="material-symbols-outlined">save</span>儲存存取碼
                    </button>
                </div>
            </div>

            <div id="settings-tab-logs" class="main-tab-content p-6 rounded-2xl shadow-lg glass-card hidden">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4">
                    <h3 class="text-xl font-bold text-slate-200">庫存盤點紀錄管理</h3>
                    <button id="delete-logs-btn" class="mt-2 sm:mt-0 w-full sm:w-auto flex items-center justify-center gap-2 py-2 px-4 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-md transition disabled:bg-slate-500 disabled:cursor-not-allowed">
                        <span class="material-symbols-outlined">delete</span>刪除選取項目
                    </button>
                </div>
                <div class="bg-slate-900/40 rounded-lg overflow-hidden border border-slate-700">
                    <div class="flex items-center justify-between p-3 bg-slate-800/50 border-b border-slate-700">
                        <label class="flex items-center gap-3 font-semibold text-slate-300">
                            <input type="checkbox" id="select-all-logs" class="rounded bg-slate-600 border-slate-500 text-sky-500 focus:ring-sky-600">
                            <span>全選</span>
                        </label>
                        <span class="font-semibold text-slate-300">紀錄資訊</span>
                    </div>
                    <div id="inventory-log-list" class="space-y-1 p-2 max-h-[50vh] overflow-y-auto">
                        </div>
                </div>
            </div>

            <div id="settings-tab-items" class="main-tab-content p-6 rounded-2xl shadow-lg glass-card hidden">
                 <h3 class="text-xl font-bold text-slate-200 mb-4">品項管理</h3>
                <div class="sub-tabs flex space-x-2 p-1 bg-slate-900/50 rounded-full">
                    <button class="sub-tab-link flex-1 py-2 px-4 text-center text-slate-300 rounded-full transition-all duration-300" data-tab="item-tab-ck">央廚庫存</button>
                    <button class="sub-tab-link flex-1 py-2 px-4 text-center text-slate-300 rounded-full transition-all duration-300" data-tab="item-tab-sf">海鮮廠商</button>
                    <button class="sub-tab-link flex-1 py-2 px-4 text-center text-slate-300 rounded-full transition-all duration-300" data-tab="item-tab-vg">菜商叫貨</button>
                </div>

                <div id="item-tab-ck" class="sub-tab-content space-y-2 mt-4"></div>
                <div id="item-tab-sf" class="sub-tab-content space-y-2 mt-4 hidden"></div>
                <div id="item-tab-vg" class="sub-tab-content space-y-2 mt-4 hidden"></div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-6">
                     <button id="add-item-btn" class="w-full flex items-center justify-center gap-2 py-3 px-4 bg-slate-700/80 hover:bg-slate-600/80 text-sky-400 font-bold rounded-lg shadow-md transition">
                        <span class="material-symbols-outlined">add</span>新增品項
                    </button>
                    <button id="save-items-btn" class="w-full flex items-center justify-center gap-2 py-3 px-4 bg-gradient-to-r from-sky-500 to-indigo-600 text-white font-bold rounded-lg shadow-md hover:shadow-lg transition">
                        <span class="material-symbols-outlined">save</span>儲存品項變更
                    </button>
                </div>
            </div>
        </main>
        
    </div>
    
    <div id="item-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-content relative w-full max-w-lg bg-slate-800 rounded-2xl shadow-xl p-6 border border-slate-600">
            <span class="close-btn absolute top-4 right-4 text-slate-400 hover:text-white cursor-pointer text-2xl font-bold">&times;</span>
            <h3 id="modal-title" class="text-xl font-bold text-slate-100 mb-4">新增品項</h3>
            <form id="item-form" class="space-y-4">
                <input type="hidden" id="modal-item-id">
                <div>
                    <label class="block text-sm font-medium text-slate-400 mb-1">品項名稱:</label>
                    <input type="text" id="modal-item-name" required class="w-full p-2 rounded-md">
                </div>
                <div>
                    <label class="block text-sm font-medium text-slate-400 mb-1">品項說明文字 (選填):</label>
                    <input type="text" id="modal-item-desc" class="w-full p-2 rounded-md">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">盤點單位:</label>
                        <input type="text" id="modal-unit-inventory" required class="w-full p-2 rounded-md">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">叫貨單位 (選填):</label>
                        <input type="text" id="modal-unit-order" placeholder="若留空，則與盤點單位相同" class="w-full p-2 rounded-md">
                    </div>
                </div>
                <div class="modal-fields-common space-y-4">
                     <div>
                        <label class="block text-sm font-medium text-slate-400 mb-1">預設盤點量 (選填):</label>
                        <input type="number" step="0.1" id="modal-default-stock" placeholder="例如: 1.5" class="w-full p-2 rounded-md">
                     </div>
                     <div class="grid grid-cols-2 gap-4">
                        <div><label class="block text-sm font-medium text-slate-400 mb-1">一般最低庫存:</label><input type="number" step="0.1" id="modal-min-stock" value="0" class="w-full p-2 rounded-md"></div>
                        <div><label class="block text-sm font-medium text-slate-400 mb-1">長假最低庫存:</label><input type="number" step="0.1" id="modal-min-stock-holiday" value="0" class="w-full p-2 rounded-md"></div>
                     </div>
                    <div><label class="block text-sm font-medium text-slate-400 mb-1">包裝方式:</label><input type="number" id="modal-package-factor" value="1" class="w-full p-2 rounded-md"></div>
                    <label class="flex items-center space-x-2 text-slate-300"><input type="checkbox" id="modal-is-required" class="rounded bg-slate-600 border-slate-500 text-sky-500 focus:ring-sky-600"><span>是否為必填</span></label>
                    <label class="flex items-center space-x-2 text-slate-300" id="modal-check-quantity-wrapper">
                        <input type="checkbox" id="modal-check-quantity" class="rounded bg-slate-600 border-slate-500 text-sky-500 focus:ring-sky-600">
                        <span>是否檢查庫存數量 > 10</span>
                    </label>
                </div>
                <div class="modal-fields-veg hidden">
                     <label class="block text-sm font-medium text-slate-400 mb-1">品項類別:</label>
                     <select id="modal-subcategory" class="w-full p-2 rounded-md">
                        <option value="-">無</option><option value="蔬菜">蔬菜</option><option value="火鍋料">火鍋料</option><option value="其他">其他</option>
                     </select>
                </div>

                <button type="submit" class="w-full py-3 bg-sky-600 text-white font-bold rounded-lg hover:bg-sky-700 transition">儲存</button>
            </form>
        </div>
    </div>

    <div id="loader" class="loader hidden">
    <div class="loader-inner ball-grid-pulse">
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
    </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="common.js"></script>
    <script src="settings.js"></script>
</body>
</html>